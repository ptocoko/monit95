@model WebApplication1.Models.Ege15VM

@{
    ViewBag.Title = "Ege15";
}

<body>
    <h3>Единый государственный экзамен - 2015</h3>
    <hr />   

    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()
    <div class="form-horizontal">
        <h4>Предметные достижения</h4>
        <div class="form-group">
            @Html.LabelFor(m => m.AreaID, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(m => m.AreaID, Model.Areas,
                       "выберете район...", new { @class = "form-control", @onchange = "GetSchools()" })
            </div>
        </div>
        @*<div class="form-group">
            @Html.LabelFor(m => m.SchoolID, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(m => m.SchoolID, Model.SchoolIDs,
                       "выберете ОО...", new { @class = "form-control", @onchange = "GetSubjects()" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(m => m.SubjectCode, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(m => m.SubjectCode, Model.Subjects,
                       "выберете предмет...", new { @class = "form-control"})
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(m => m.ReportCode, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(x => x.ReportCode, new[]
                    {
                      new SelectListItem() { Text = "образовательная организация", Value = "3" },
                      new SelectListItem() { Text = "участники", Value = "5" },
                    }, "выберите тип отчета...", new { @class = "form-control" })
            </div>
        </div>*@

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Создать отчет" class="btn btn-success" />
            </div>
        </div>
    </div>

    <div class="form-horizontal">
        <hr>
        <h4>Статистика</h4>

        <div class="form-group">
            @Html.LabelFor(m => m.SchoolName, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <div class="form-control-static">
                    @Model.SchoolName
                </div>
                
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input id="merge" type="button" onclick="CreateMergeReport()" value="Сводный отчет" class="btn btn-success" />
            </div>
        </div>
    </div>
    }

    
    
</body>

<script type="text/jscript">

    function FillParticip() {
        console.log("FillParticip");
        var subjectCode = $('#SubjectCode').val();
        $.ajax({
            url: '/Home/FillParticip',
            type: "GET",
            dataType: "JSON",
            data: { _subjectCode: subjectCode },
            success: function (particips) {
                $("#ParticipantID").html(""); // clear before appending new list
                $.each(particips, function (i, particip)
                {
                    $("#ParticipantID").append(
                        $('<option></option>').val(particip.ParticipantID).html(particip.surname));
                });
            }
        });
    }

    function CreateMergeReport()
    {
        $.get("/Home/MergeReport?_param=1");

            console.log("Yes!");
    };

</script>